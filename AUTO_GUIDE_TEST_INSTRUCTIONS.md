# 自动引导功能测试说明

## 测试目的

验证第一次进入每个页面时自动弹出引导界面的功能是否正常工作。

## 测试环境

- 浏览器：Chrome/Firefox/Safari
- 开发服务器：`npm run dev`
- URL：http://localhost:5173/flying-chess/

## 测试步骤

### 1. 首次访问测试

1. **清除浏览器缓存**
   - **方法一**：打开浏览器开发者工具（F12），清除 localStorage 和 sessionStorage
   - **方法二**：使用无痕/隐私模式
   - **方法三**：🆕 在游戏首页点击"清空缓存"按钮

2. **访问应用首页**
   - 访问 http://localhost:5173/flying-chess/
   - 观察是否在1-2秒内自动弹出引导界面
   - 引导应该介绍：游戏标题、玩家设置、游戏特色、开始按钮

3. **测试棋盘设置页面**
   - 点击"开始游戏"进入棋盘设置页面
   - 观察是否自动弹出引导界面
   - 引导应该介绍：格子配置、机关陷阱、起飞失败设置、操作按钮

4. **测试惩罚设置页面**
   - 点击"下一步：惩罚设置"进入惩罚设置页面
   - 观察是否自动弹出引导界面
   - 引导应该介绍：工具设置、身体部位、姿势配置、惩罚次数

5. **测试惩罚确认页面**
   - 在惩罚设置页面完成配置后，点击"开始游戏"
   - 系统会生成惩罚组合并弹出确认窗口
   - 观察确认窗口弹出后是否在500ms内自动显示引导
   - 引导应该介绍：组合列表、组合详情、删除/恢复操作、统计信息、操作按钮

6. **测试游戏页面（棋盘页面）**
   - 在惩罚确认页面点击"确认组合"进入游戏页面
   - 观察游戏页面载入后是否自动显示引导
   - 引导应该介绍：骰子区域、游戏状态、棋盘区域、控制按钮

### 2. 手动引导测试

1. **手动触发引导**
   - 在任意页面点击右下角的"❓ 帮助"按钮
   - 应该立即弹出当前页面的引导
   - 特别测试：在惩罚确认弹窗显示时点击帮助按钮，应该显示确认页面专用引导

2. **引导设置测试**
   - 点击左下角的"⚙️"设置按钮
   - 测试"自动显示引导"开关
   - 测试"重置引导"功能

### 3. 状态记忆测试

1. **查看已显示的引导**
   - 第一次看过引导后，重新进入相同页面
   - 应该不会再次自动弹出引导

2. **重置状态测试**
   - 点击设置中的"重置引导"按钮
   - 重新访问页面，应该再次弹出自动引导

### 4. 开关控制测试

1. **关闭自动引导**
   - 在设置中取消"自动显示引导"勾选
   - 清除localStorage重新访问
   - 应该不会自动弹出引导

2. **开启自动引导**
   - 重新勾选"自动显示引导"
   - 点击"重置引导"
   - 重新访问页面，应该恢复自动引导

### 5. 首页清空缓存功能测试

**🆕 新增测试项目**

1. **基础功能测试**
   - 访问游戏首页
   - 找到"清空缓存"按钮（在"开始游戏"按钮下方）
   - 点击按钮
   - 观察是否显示绿色成功提示

2. **清空效果验证**
   - 点击"清空缓存"按钮
   - 刷新页面（F5）
   - 应该重新弹出开始页面的自动引导

3. **跨页面测试**
   - 在首页点击"清空缓存"
   - 导航到棋盘设置页面
   - 应该弹出棋盘设置的自动引导

4. **重复操作测试**
   - 多次点击"清空缓存"按钮
   - 每次都应该显示成功提示
   - 功能应该稳定工作

5. **移动端适配测试**
   - 在移动设备或缩小浏览器窗口
   - 验证按钮样式和提示位置正确
   - 确保触摸操作正常

## 调试信息

打开浏览器控制台查看以下调试信息：

```
检查自动引导 - 页面类型: intro, 自动引导开启: true, 已显示过: false
准备显示自动引导 - 页面: intro
执行自动引导 - 页面: intro
```

## 预期结果

- ✅ 首次访问每个页面自动弹出引导
- ✅ 引导内容准确对应当前页面
- ✅ 状态记忆功能正常（不重复显示）
- ✅ 手动引导按钮正常工作
- ✅ 自动引导开关控制有效
- ✅ 重置引导功能正常
- ✅ 设置持久化保存
- ✅ 🆕 首页清空缓存按钮正常工作
- ✅ 🆕 清空缓存后引导重新激活
- ✅ 🆕 成功提示正确显示和消失

## 常见问题排查

### 1. 自动引导没有弹出

- 检查控制台是否有调试信息
- 确认 `autoGuideEnabled` 是否为 `true`
- 确认页面状态是否在监听范围内
- 检查页面元素是否正确渲染

### 2. 引导重复弹出

- 检查 `hasShownGuide` 状态
- 确认localStorage持久化是否正常
- 查看状态记忆逻辑

### 3. 引导内容不正确

- 确认CSS选择器是否正确
- 检查页面元素是否存在
- 验证引导步骤配置

## 性能说明

- 引导延迟：800ms（确保页面渲染完成）
- 自动检查：nextTick + setTimeout双重保障
- 状态持久化：localStorage自动保存
- 内存占用：轻量级，仅5KB库大小
