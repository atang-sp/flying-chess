# 📱 移动端扫码功能使用指南

## 🎯 功能概述

飞行棋游戏现在支持在移动端通过摄像头直接扫描二维码来导入配置，让分享和导入配置变得更加便捷。

## 📋 功能特点

### ✅ 支持的功能

- **自动设备检测**：自动识别移动设备并显示扫码选项
- **摄像头权限管理**：智能处理摄像头权限请求
- **实时扫码**：支持实时扫描二维码配置
- **多格式支持**：支持各种二维码格式和配置数据
- **错误处理**：完善的错误提示和处理机制

### 📱 支持的设备

- **iOS设备**：iPhone、iPad（Safari、Chrome等浏览器）
- **Android设备**：各品牌Android手机和平板（Chrome、Firefox等浏览器）
- **其他移动设备**：支持摄像头的移动设备

## 🚀 使用方法

### 步骤1: 打开配置导入

1. 在游戏主界面点击右下角的 `📤 导出` 按钮
2. 在弹出的对话框中点击 `导入` 标签页
3. 移动端会自动显示 `📷 扫码导入` 选项

### 步骤2: 开始扫码

1. 点击 `📱 开始扫码` 按钮
2. 浏览器会请求摄像头权限，点击 `允许`
3. 扫码器界面会自动打开

### 步骤3: 扫描二维码

1. 将摄像头对准要导入的配置二维码
2. 确保二维码完整显示在扫描框内
3. 系统会自动识别并导入配置

### 步骤4: 完成导入

1. 扫码成功后会自动解析配置数据
2. 系统验证配置有效性
3. 导入成功后会自动应用新配置

## 🔧 技术要求

### 浏览器支持

- **iOS Safari** 11.0+
- **Chrome Mobile** 67+
- **Firefox Mobile** 68+
- **Samsung Internet** 8.0+
- **其他现代移动浏览器**

### 权限要求

- **摄像头权限**：必须允许网站访问摄像头
- **HTTPS连接**：现代浏览器要求HTTPS才能访问摄像头

### 环境要求

- **光线充足**：确保二维码清晰可见
- **稳定持握**：避免手抖影响扫码
- **适当距离**：保持10-30cm的扫码距离

## 💡 使用技巧

### 扫码最佳实践

1. **保持稳定**：双手持握设备，保持稳定
2. **调整距离**：根据二维码大小调整扫码距离
3. **充足光线**：在光线充足的环境下扫码
4. **对准中心**：将二维码置于扫描框中心
5. **耐心等待**：给系统1-2秒的识别时间

### 常见问题解决

1. **权限被拒绝**：
   - 检查浏览器设置中的摄像头权限
   - 刷新页面重新请求权限
   - 尝试使用其他浏览器

2. **扫码失败**：
   - 确保二维码图片清晰完整
   - 调整扫码距离和角度
   - 检查光线是否充足

3. **导入失败**：
   - 确认二维码是游戏生成的配置二维码
   - 检查配置数据是否完整
   - 尝试重新扫码

## 🛠️ 开发者信息

### 技术实现

- **扫码库**：qr-scanner v1.4.2
- **摄像头API**：MediaDevices.getUserMedia()
- **设备检测**：User-Agent 分析
- **权限处理**：Permissions API

### 核心组件

```typescript
// 扫码功能核心方法
const startScanning = async () => {
  // 检查摄像头支持
  if (!QrScanner.hasCamera()) return

  // 创建扫码器
  const qrScanner = new QrScanner(video, handleResult, options)

  // 启动扫码
  await qrScanner.start()
}
```

### 配置选项

```typescript
const scannerOptions = {
  returnDetailedScanResult: true,
  highlightScanRegion: true,
  highlightCodeOutline: true,
}
```

## 🧪 测试页面

### 移动端测试

访问 `mobile-scan-test.html` 进行完整的移动端扫码功能测试：

1. 设备信息检测
2. 测试二维码生成
3. 扫码功能验证
4. 结果解析测试

### 测试步骤

1. 在移动设备上打开测试页面
2. 点击 `生成测试二维码`
3. 点击 `开始扫码` 测试摄像头
4. 扫描生成的测试二维码
5. 验证解析结果

## 🔒 隐私和安全

### 数据安全

- **本地处理**：所有扫码和解析都在本地进行
- **无数据上传**：不会将摄像头数据或配置数据上传到服务器
- **权限控制**：用户完全控制摄像头权限

### 隐私保护

- **临时访问**：只在扫码时临时访问摄像头
- **自动停止**：扫码完成后自动停止摄像头
- **无存储**：不存储任何摄像头画面或个人信息

## 📞 故障排除

### 常见错误及解决方案

1. **"设备不支持摄像头"**
   - 检查设备是否有摄像头
   - 确认浏览器支持摄像头API
   - 尝试使用其他浏览器

2. **"摄像头权限被拒绝"**
   - 在浏览器设置中允许摄像头权限
   - 刷新页面重新请求权限
   - 检查是否为HTTPS连接

3. **"无法识别二维码"**
   - 确保二维码清晰完整
   - 调整光线和距离
   - 检查二维码是否为有效格式

4. **"配置导入失败"**
   - 确认二维码包含有效的配置数据
   - 检查配置版本兼容性
   - 尝试使用文件导入方式

### 获取帮助

如果遇到问题：

1. 查看浏览器控制台的错误信息
2. 尝试使用测试页面进行诊断
3. 联系开发者获取技术支持

---

_最后更新：2025-07-21_
_版本：v1.0.0_
