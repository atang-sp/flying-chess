<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æƒ©ç½šç³»ç»Ÿæµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .combination {
            background: #f8f9fa;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        .strikes {
            color: #dc3545;
            font-weight: bold;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .result {
            background: #e7f3ff;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ æƒ©ç½šç³»ç»Ÿæµ‹è¯•</h1>
        <p>æµ‹è¯•æ–°çš„æƒ©ç½šç³»ç»Ÿé€»è¾‘ï¼šæƒ©ç½šç»„åˆå®šä¹‰ä¸æƒ©ç½šæ•°é‡åˆ†ç¦»</p>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•1ï¼šç”Ÿæˆæƒ©ç½šç»„åˆå®šä¹‰ï¼ˆä¸åŒ…å«æ¬¡æ•°ï¼‰</div>
            <button onclick="testCombinationDefinitions()">ç”Ÿæˆç»„åˆå®šä¹‰</button>
            <div id="combinations-result" class="result" style="display:none;"></div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•2ï¼šä»ç»„åˆå®šä¹‰ç”Ÿæˆå¸¦æ¬¡æ•°çš„æƒ©ç½šåŠ¨ä½œ</div>
            <button onclick="testPunishmentActions()">ç”Ÿæˆæƒ©ç½šåŠ¨ä½œ</button>
            <div id="actions-result" class="result" style="display:none;"></div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•3ï¼šéªŒè¯åŒä¸€ç»„åˆå¯ä»¥æœ‰ä¸åŒæ¬¡æ•°</div>
            <button onclick="testDifferentStrikes()">æµ‹è¯•ä¸åŒæ¬¡æ•°</button>
            <div id="strikes-result" class="result" style="display:none;"></div>
        </div>
    </div>

    <script type="module">
        // æ¨¡æ‹Ÿæƒ©ç½šé…ç½®
        const mockConfig = {
            tools: [
                { id: 'hand', name: 'æ‰‹æŒ', intensity: 2, ratio: 50 },
                { id: 'ruler', name: 'å°ºå­', intensity: 4, ratio: 30 }
            ],
            bodyParts: [
                { id: 'butt', name: 'å±è‚¡', sensitivity: 5, ratio: 60 },
                { id: 'palm', name: 'æ‰‹å¿ƒ', sensitivity: 3, ratio: 40 }
            ],
            positions: [
                { id: 'standing', name: 'ç«™ç«‹', ratio: 50 },
                { id: 'bending', name: 'å¼¯è…°', ratio: 50 }
            ],
            minStrikes: 10,
            maxStrikes: 30,
            step: 5
        };

        // æ¨¡æ‹ŸGameServiceçš„æ–¹æ³•
        class MockGameService {
            static createPunishmentCombinationDefinition(tool, bodyPart, position) {
                return {
                    tool,
                    bodyPart,
                    position,
                    description: `ç”¨${tool.name}æ‰“${bodyPart.name}ï¼Œå§¿åŠ¿ï¼š${position.name}`
                };
            }

            static createPunishmentActionFromCombination(combination, config) {
                const minStrikes = Math.max(1, config.minStrikes || 10);
                const maxStrikes = Math.max(minStrikes, config.maxStrikes || 30);
                const step = config.step || 5;

                const minMultiple = Math.ceil(minStrikes / step);
                const maxMultiple = Math.floor(maxStrikes / step);

                const randomMultiple = Math.floor(Math.random() * (maxMultiple - minMultiple + 1)) + minMultiple;
                const strikes = randomMultiple * step;

                return {
                    tool: combination.tool,
                    bodyPart: combination.bodyPart,
                    position: combination.position,
                    strikes,
                    description: `ç”¨${combination.tool.name}æ‰“${combination.bodyPart.name}${strikes}ä¸‹ï¼Œå§¿åŠ¿ï¼š${combination.position.name}`
                };
            }

            static generateBalancedPunishmentCombinationDefinitions(config, count = 4) {
                const combinations = [];
                const validTools = config.tools.filter(tool => tool.ratio > 0);
                const validBodyParts = config.bodyParts.filter(bodyPart => bodyPart.ratio > 0);
                const validPositions = config.positions.filter(position => position.ratio > 0);

                for (let i = 0; i < count && i < validTools.length * validBodyParts.length * validPositions.length; i++) {
                    const tool = validTools[i % validTools.length];
                    const bodyPart = validBodyParts[Math.floor(i / validTools.length) % validBodyParts.length];
                    const position = validPositions[Math.floor(i / (validTools.length * validBodyParts.length)) % validPositions.length];
                    
                    if (tool.intensity <= bodyPart.sensitivity) {
                        combinations.push(this.createPunishmentCombinationDefinition(tool, bodyPart, position));
                    }
                }

                return combinations;
            }
        }

        // æµ‹è¯•å‡½æ•°
        window.testCombinationDefinitions = function() {
            const combinations = MockGameService.generateBalancedPunishmentCombinationDefinitions(mockConfig, 4);
            const resultDiv = document.getElementById('combinations-result');
            
            let html = '<h4>ç”Ÿæˆçš„æƒ©ç½šç»„åˆå®šä¹‰ï¼š</h4>';
            combinations.forEach((combo, index) => {
                html += `<div class="combination">
                    <strong>#${index + 1}</strong>: ${combo.description}
                    <br><small>å·¥å…·: ${combo.tool.name} (å¼ºåº¦${combo.tool.intensity}) | éƒ¨ä½: ${combo.bodyPart.name} (è€å—åº¦${combo.bodyPart.sensitivity}) | å§¿åŠ¿: ${combo.position.name}</small>
                </div>`;
            });
            
            resultDiv.innerHTML = html;
            resultDiv.style.display = 'block';
        };

        window.testPunishmentActions = function() {
            const combinations = MockGameService.generateBalancedPunishmentCombinationDefinitions(mockConfig, 4);
            const resultDiv = document.getElementById('actions-result');
            
            let html = '<h4>ä»ç»„åˆå®šä¹‰ç”Ÿæˆçš„æƒ©ç½šåŠ¨ä½œï¼š</h4>';
            combinations.forEach((combo, index) => {
                const action = MockGameService.createPunishmentActionFromCombination(combo, mockConfig);
                html += `<div class="combination">
                    <strong>#${index + 1}</strong>: ${action.description}
                    <br><small>æ¬¡æ•°: <span class="strikes">${action.strikes}ä¸‹</span></small>
                </div>`;
            });
            
            resultDiv.innerHTML = html;
            resultDiv.style.display = 'block';
        };

        window.testDifferentStrikes = function() {
            const combination = MockGameService.createPunishmentCombinationDefinition(
                mockConfig.tools[0], 
                mockConfig.bodyParts[0], 
                mockConfig.positions[0]
            );
            
            const resultDiv = document.getElementById('strikes-result');
            
            let html = `<h4>åŒä¸€ç»„åˆç”Ÿæˆçš„ä¸åŒæ¬¡æ•°ï¼š</h4>`;
            html += `<p><strong>ç»„åˆå®šä¹‰</strong>: ${combination.description}</p>`;
            html += `<p><strong>ç”Ÿæˆçš„ä¸åŒæ¬¡æ•°</strong>:</p>`;
            
            for (let i = 0; i < 10; i++) {
                const action = MockGameService.createPunishmentActionFromCombination(combination, mockConfig);
                html += `<div class="combination">
                    ç¬¬${i + 1}æ¬¡ç”Ÿæˆ: <span class="strikes">${action.strikes}ä¸‹</span> - ${action.description}
                </div>`;
            }
            
            resultDiv.innerHTML = html;
            resultDiv.style.display = 'block';
        };
    </script>
</body>
</html>
